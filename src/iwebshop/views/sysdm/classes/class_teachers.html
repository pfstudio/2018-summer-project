<div class="breadcrumbs" id="breadcrumbs">
  <ul class="breadcrumb">
    <li>
      <i class="home-icon fa fa-home"></i>
      <a href="#">课程</a>
    </li>
    <li>
      <a href="#">教学班管理</a>
    </li>
    <li class="active">班级教师</li>
  </ul>
</div>

<div class="content">
  <table class="table list-table">
    <colgroup>
      <col width="35px" />
      <col width="150px" />
      <col width="100px" />
      <col width="100px" />
      <col width="200px" />
      <col />
      <col width="200px" />
      <col width="200px" />
    </colgroup>
    <caption>
      <a class="btn btn-default" onclick="addTeachers({$class['id']})">
        <i class="fa fa-plus"></i>添加教师
      </a>
      <a class="btn btn-default" onclick="selectAll('check[]')">
        <i class="fa fa-check"></i>全选
      </a>
      <a class="btn btn-default" onclick="delModel({'form':'class_list',msg:'确定要移除所选中的学生吗？'})">
        <i class="fa fa-close"></i>批量删除
      </a>
    </caption>
    <thead>
      <tr>
        <th></th>
        <th>照片</th>
        <th>姓名</th>
        <th>性别</th>
        <th>电话</th>
        <th>邮箱</th>
        <th>微信</th>
        <th></th>
      </tr>
    </thead>
    <!-- 用于全部删除 -->
    <form action="{url:/classes/remove_teachers}" method="post" name="teacher_list" onsubmit="return checkboxCheck('check[]','尚未选中任何记录！')">
      <input name="id" value="{$class['id']}" hidden />
      <tbody>
        {foreach:items=$this->query->find()}
        <tr>
          <td>
            <input name="check[]" type="checkbox" value="{$item['id']}" />
          </td>
          <td>
            {if:isset($item['photo']) && $item['photo']}
            <img src="{$item['photo']}" alt="{$item['photo']}" style="width:150px;border:1px solid #ccc" />
            {else:}
            <i class="fa fa-photo"></i>暂无照片
            {/if}
          </td>
          <td title="{echo:htmlspecialchars($item['name'])}">{$item['name']}</td>
          <td>{if:$item['sex']==0}男{else:}女{/if}</td>
          <td>{$item['phone']}</td>
          <td>{$item['email']}</td>
          <td>{$item['wechat']}</td>
          <td>
            <a onclick="delModel({link:'{url:/classes/remove_teachers/id/$class['id']/check/$item['id']}'})" title="删除">
              <i class='operator fa fa-close'></i>
            </a>
          </td>
        </tr>
        {/foreach}
      </tbody>
    </form>
  </table>
</div>
{$this->query->getPageBar()}
<script>
  function addTeachers(id) {
    art.dialog.open('{url:/teachers/teacher_search}', {
      'id': 'search',
      'title': '添加教师',
      'width': '790px',
      ok: function (iframeWin, topWin) {
        let formObject = iframeWin.document.forms['teacherForm'];
        let postData = 'id=' + id + '&' + $(formObject).serialize();
        $.post('{url:/classes/add_teachers}', postData,
          function (res) {
            if(res.status == 'success')
              location.reload();
            else
              alert(res.error.join('|'));
          });
      }
    });
  }
</script>